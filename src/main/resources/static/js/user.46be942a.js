(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["user","chunk-2bca9e6c","chunk-6f812bb9","chunk-2d0aa1b9"],{1037:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-result",{attrs:{isSuccess:!0,content:!1,title:e.email,"sub-title":e.description},scopedSlots:e._u([{key:"extra",fn:function(){return[a("a-button",{attrs:{size:"large",type:"primary"}},[e._v("查看邮箱")]),a("a-button",{staticStyle:{"margin-left":"8px"},attrs:{size:"large"},on:{click:e.goHomeHandle}},[e._v("返回首页")])]},proxy:!0}])})},s=[],n={name:"RegisterResult",data:function(){return{description:"激活邮件已发送到你的邮箱中，邮件有效期为24小时。请及时登录邮箱，点击邮件中的链接激活帐户。",form:{}}},computed:{email:function(){var e=this.form&&this.form.email||"xxx";return"你的账户：".concat(e," 注册成功")}},created:function(){this.form=this.$route.params},methods:{goHomeHandle:function(){this.$router.push({name:"login"})}}},i=n,o=a("2877"),c=Object(o["a"])(i,r,s,!1,null,"1cbae610",null);t["default"]=c.exports},1348:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main user-layout-register"},[a("h3",[a("span",[e._v(e._s(e.pageTitle))])]),a("a-form",{ref:"formRegister",attrs:{form:e.form,id:"formRegister"}},[a("a-form-item",{attrs:{"has-feedback":""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["email",{rules:[{required:!0,type:"email",message:"请输入邮箱地址"},{validator:e.validateEmail}],validateTrigger:["blur"]}],expression:"[\n          'email',\n          {\n            rules: [\n              { required: true, type: 'email', message: '请输入邮箱地址' },\n              {\n                validator: validateEmail\n              }\n            ],\n            validateTrigger: ['blur']\n          }\n        ]"}],attrs:{size:"large",type:"text",placeholder:"邮箱"}})],1),a("a-popover",{attrs:{placement:"rightTop",trigger:["focus"],getPopupContainer:function(e){return e.parentElement}},model:{value:e.state.passwordLevelChecked,callback:function(t){e.$set(e.state,"passwordLevelChecked",t)},expression:"state.passwordLevelChecked"}},[a("template",{slot:"content"},[a("div",{style:{width:"240px"}},[a("div",{class:["user-register",e.passwordLevelClass]},[e._v(" 强度："),a("span",[e._v(e._s(e.passwordLevelName))])]),a("a-progress",{attrs:{percent:e.state.percent,showInfo:!1,strokeColor:e.passwordLevelColor}}),a("div",{staticStyle:{"margin-top":"10px"}},[a("span",[e._v("请至少输入 6 个字符。请不要使用容易被猜到的密码。")])])],1)]),a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["password",{rules:[{required:!0,message:"至少6位密码，区分大小写"},{validator:this.handlePasswordLevel}],validateTrigger:["change","blur"]}],expression:"[\n            'password',\n            {\n              rules: [\n                { required: true, message: '至少6位密码，区分大小写' },\n                { validator: this.handlePasswordLevel }\n              ],\n              validateTrigger: ['change', 'blur']\n            }\n          ]"}],attrs:{size:"large",type:"password",autocomplete:"false",placeholder:"至少6位密码，区分大小写"},on:{click:e.handlePasswordInputClick}})],1)],2),a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["password2",{rules:[{required:!0,message:"至少6位密码，区分大小写"},{validator:this.handlePasswordCheck}],validateTrigger:["change","blur"]}],expression:"[\n          'password2',\n          {\n            rules: [{ required: true, message: '至少6位密码，区分大小写' }, { validator: this.handlePasswordCheck }],\n            validateTrigger: ['change', 'blur']\n          }\n        ]"}],attrs:{size:"large",type:"password",autocomplete:"false",placeholder:"确认密码"}})],1),a("a-row",{attrs:{gutter:16}},[a("a-col",{staticClass:"gutter-row",attrs:{span:16}},[a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["captcha",{rules:[{required:!0,message:"请输入验证码"}],validateTrigger:"blur"}],expression:"[\n              'captcha',\n              { rules: [{ required: true, message: '请输入验证码' }], validateTrigger: 'blur' }\n            ]"}],attrs:{size:"large",type:"text",placeholder:"验证码"}},[a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"mail"},slot:"prefix"})],1)],1)],1),a("a-col",{staticClass:"gutter-row",attrs:{span:8}},[a("a-button",{staticClass:"getCaptcha",attrs:{size:"large",disabled:e.state.smsSendBtn},domProps:{textContent:e._s(e.state.smsSendBtn?e.state.time+" s":"获取验证码")},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.getCaptcha(t)}}})],1)],1),a("a-form-item",[a("a-button",{staticClass:"register-button",attrs:{size:"large",type:"primary",htmlType:"submit",loading:e.registerBtn,disabled:e.registerBtn},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleSubmit(t)}}},[e._v(" "+e._s(e.createBtnTitle)+" ")]),a("router-link",{staticClass:"login",attrs:{to:{name:"login"}}},[e._v(" 使用已有账户登录 ")])],1)],1)],1)},s=[],n=(a("d3b7"),a("498a"),a("5530")),i=a("432b"),o=a("ca00"),c=a("c24f"),l=a("b775"),u={sendEmailCaptcha:function(e){return Object(l["b"])({url:"/mail/captcha",method:"get",params:e})}},d=u,p=a("5880"),m=a("2ef0"),h=function(e,t,a){t?c["a"].checkEmail(t).then((function(e){e.data?a(new Error("邮箱地址已经被使用")):a()})):a()},f={0:"低",1:"低",2:"中",3:"强"},g={0:"error",1:"error",2:"warning",3:"success"},v={0:"#ff0000",1:"#ff0000",2:"#ff7e05",3:"#52c41a"},b={name:"Register",components:{},mixins:[i["a"]],data:function(){return{form:this.$form.createForm(this),state:{time:60,smsSendBtn:!1,passwordLevel:0,passwordLevelChecked:!1,percent:10,progressColor:"#FF0000"},validateEmail:h,registerBtn:!1,socialLoginAuthUser:{}}},computed:{passwordLevelClass:function(){return g[this.state.passwordLevel]},passwordLevelName:function(){return f[this.state.passwordLevel]},passwordLevelColor:function(){return v[this.state.passwordLevel]},pageTitle:function(){return Object(m["isEmpty"])(this.socialLoginAuthUser)?"创建帐号":"第三方帐号未绑定，立即创建帐号完成绑定"},createBtnTitle:function(){return Object(m["isEmpty"])(this.socialLoginAuthUser)?"注册":"创建帐号"}},created:function(){this.socialLoginAuthUser=this.$route.params,this.$log.debug(this.socialLoginAuthUser)},destroyed:function(){this.$log.debug("清空socialLoginAuthUser")},methods:Object(n["a"])(Object(n["a"])({},Object(p["mapActions"])(["SocialSignLogin"])),{},{handlePasswordLevel:function(e,t,a){var r=0;/[0-9]/.test(t)&&r++,/[a-zA-Z]/.test(t)&&r++,/[^0-9a-zA-Z_]/.test(t)&&r++,this.state.passwordLevel=r,this.state.percent=30*r,r>=2?(r>=3&&(this.state.percent=100),a()):(0===r&&(this.state.percent=10),a(new Error("密码强度不够")))},handlePasswordCheck:function(e,t,a){var r=this.form.getFieldValue("password");void 0===t&&a(new Error("请输入密码")),t&&r&&t.trim()!==r.trim()&&a(new Error("两次密码不一致")),a()},handlePasswordInputClick:function(){this.isMobile?this.state.passwordLevelChecked=!1:this.state.passwordLevelChecked=!0},handleSubmit:function(){var e=this,t=this.form.validateFields,a=this.state,r=this.$router;t({force:!0},(function(t,s){if(!t)if(a.passwordLevelChecked=!1,e.registerBtn=!0,e.socialLoginAuthUser){var i=Object.assign({},s);e.socialLoginAuthUser.token=null,i.authUser=e.socialLoginAuthUser,e.SocialSignLogin(i).then((function(t){e.registerBtn=!1,e.loginSuccess(t)})).finally((function(){e.registerBtn=!1}))}else r.push({name:"registerResult",params:Object(n["a"])({},s)}),e.registerBtn=!1}))},loginSuccess:function(e){var t=this;this.$router.push({name:"dashboard"}),setTimeout((function(){t.$notification.success({message:"欢迎",description:"".concat(Object(o["a"])(),"，欢迎加入")})}),1e3)},getCaptcha:function(e){e.preventDefault();var t=this.form.validateFields,a=this.state,r=this.$message;t(["email"],{force:!0},(function(e,t){if(!e){a.smsSendBtn=!0;var s=window.setInterval((function(){a.time--<=0&&(a.time=60,a.smsSendBtn=!1,window.clearInterval(s))}),1e3);r.loading("验证码发送中.."),d.sendEmailCaptcha(t).then((function(e){r.success("验证码发送成功")}))}}))},requestFailed:function(e){this.$notification["error"]({message:"错误",description:((e.response||{}).data||{}).message||"请求出现错误，请稍后再试",duration:4}),this.registerBtn=!1}}),watch:{"state.passwordLevel":function(e){}}},w=b,y=(a("5d18"),a("ef6a"),a("2877")),C=Object(y["a"])(w,r,s,!1,null,"74aae09f",null);t["default"]=C.exports},"3a88":function(e,t,a){"use strict";a("f214")},"432b":function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var r=a("5530"),s=a("5880"),n={computed:Object(r["a"])(Object(r["a"])({},Object(s["mapState"])({layout:function(e){return e.app.layout},navTheme:function(e){return e.app.theme},primaryColor:function(e){return e.app.color},colorWeak:function(e){return e.app.weak},fixedHeader:function(e){return e.app.fixedHeader},fixedSidebar:function(e){return e.app.fixedSidebar},contentWidth:function(e){return e.app.contentWidth},autoHideHeader:function(e){return e.app.autoHideHeader},isMobile:function(e){return e.app.isMobile},sideCollapsed:function(e){return e.app.sideCollapsed},multiTab:function(e){return e.app.multiTab}})),{},{isTopMenu:function(){return"topmenu"===this.layout}}),methods:{isSideMenu:function(){return!this.isTopMenu}}}},"5d18":function(e,t,a){"use strict";a("eeab")},ac2a:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main"},[a("a-form",{ref:"formLogin",staticClass:"user-layout-login",attrs:{id:"formLogin",form:e.form},on:{submit:e.handleSubmit}},[a("a-tabs",{attrs:{activeKey:e.customActiveKey,tabBarStyle:{textAlign:"center",borderBottom:"unset"}},on:{change:e.handleTabClick}},[a("a-tab-pane",{key:"tab1",attrs:{tab:"账号密码登录"}},[a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["username",{rules:[{required:!0,message:"请输入帐户名或邮箱地址"},{validator:e.handleUsernameOrEmail}],validateTrigger:"change"}],expression:"[\n              'username',\n              {\n                rules: [\n                  { required: true, message: '请输入帐户名或邮箱地址' },\n                  { validator: handleUsernameOrEmail }\n                ],\n                validateTrigger: 'change'\n              }\n            ]"}],attrs:{size:"large",type:"text",placeholder:"账户: test"}},[a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"user"},slot:"prefix"})],1)],1),a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["password",{rules:[{required:!0,message:"请输入密码"}],validateTrigger:"blur"}],expression:"[\n              'password',\n              {\n                rules: [{ required: true, message: '请输入密码' }],\n                validateTrigger: 'blur'\n              }\n            ]"}],attrs:{size:"large",type:"password",autocomplete:"false",placeholder:"密码: 123456"}},[a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1)],1)],1),a("a-form-item",[a("a-checkbox",{directives:[{name:"decorator",rawName:"v-decorator",value:["rememberMe"],expression:"['rememberMe']"}],attrs:{checked:""}},[e._v("自动登录")]),a("router-link",{staticClass:"forge-password",staticStyle:{float:"right"},attrs:{to:{name:"recover",params:{user:"aaa"}}}},[e._v(" 忘记密码")])],1),a("a-form-item",{staticStyle:{"margin-top":"24px"}},[a("a-button",{staticClass:"login-button",attrs:{size:"large",type:"primary",htmlType:"submit",loading:e.state.loginBtn,disabled:e.state.loginBtn}},[e._v(" 确定 ")])],1)],1)],1)},s=[],n=(a("99af"),a("d3b7"),a("5530")),i=a("5880"),o=a("ca00"),c=a("7ded"),l={data:function(){return{customActiveKey:"tab1",loginBtn:!1,loginType:0,requiredTwoStepCaptcha:!1,stepCaptchaVisible:!1,form:this.$form.createForm(this),state:{time:60,loginBtn:!1,loginType:0,smsSendBtn:!1},socialPage:{width:.5*window.screen.width,height:.5*window.screen.height}}},destroyed:function(){window.removeEventListener("message",this.resolveSocialLogin)},methods:Object(n["a"])(Object(n["a"])({},Object(i["mapActions"])(["Login","SocialLogin","Logout"])),{},{handleUsernameOrEmail:function(e,t,a){var r=this.state,s=/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((\.[a-zA-Z0-9_-]{2,3}){1,2})$/;s.test(t)?r.loginType=0:r.loginType=1,a()},handleTabClick:function(e){this.customActiveKey=e},handleSubmit:function(e){var t=this;e.preventDefault();var a=this.form.validateFields,r=this.state,s=this.customActiveKey,i=this.Login;r.loginBtn=!0;var o="tab1"===s?["username","password"]:["mobile","captcha"];a(o,{force:!0},(function(e,a){if(e)setTimeout((function(){r.loginBtn=!1}),600);else{var s=Object(n["a"])({},a);delete s.username,s[r.loginType?"username":"email"]=a.username,s.password=a.password,s.loginType=r.loginType,i(s).then((function(e){return t.loginSuccess(e)})).catch((function(e){return t.requestFailed(e)})).finally((function(){r.loginBtn=!1}))}}))},getCaptcha:function(e){var t=this;e.preventDefault();var a=this.form.validateFields,r=this.state;a(["mobile"],{force:!0},(function(e,a){if(!e){r.smsSendBtn=!0;var s=window.setInterval((function(){r.time--<=0&&(r.time=60,r.smsSendBtn=!1,window.clearInterval(s))}),1e3);t.$message.loading("验证码发送中..",0)}}))},stepCaptchaSuccess:function(){this.loginSuccess()},stepCaptchaCancel:function(){var e=this;this.Logout().then((function(){e.loginBtn=!1,e.stepCaptchaVisible=!1}))},loginSuccess:function(e){var t=this;this.$router.push({name:"dashboard"}),setTimeout((function(){t.$notification.success({message:"欢迎",description:"".concat(Object(o["a"])(),"，欢迎回来")})}),1e3)},requestFailed:function(e){this.$notification["error"]({message:"错误",description:((e.response||{}).data||{}).message||"请求出现错误，请稍后再试",duration:4})},handleSocialLogin:function(e){var t="".concat(c["g"],"/").concat(e,"/login");window.open(t,"newWindow","resizable=yes, height=".concat(this.socialPage.height,",\n      width=").concat(this.socialPage.width,", top=10%, left=10%, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no")),window.addEventListener("message",this.resolveSocialLogin,!1)},resolveSocialLogin:function(e){var t=this,a=e.data;a.isBind?(this.$log.debug("resolveSocialLogin data is bind:",a.accessToken),this.SocialLogin(a.accessToken).then((function(e){t.loginSuccess(e)}))):(this.$log.debug("socail account not bind jump register page to bind"),this.$router.push({name:"register",params:a.authUser}))}})},u=l,d=(a("3a88"),a("2877")),p=Object(d["a"])(u,r,s,!1,null,"7d786a38",null);t["default"]=p.exports},c24f:function(e,t,a){"use strict";var r=a("b775"),s={list:function(e){return Object(r["b"])({url:"/user/list",method:"get",params:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})},create:function(e){return Object(r["b"])({url:"/user",method:"post",data:e})},update:function(e){return Object(r["b"])({url:"/user",method:"put",data:e})},updateProfile:function(e){return Object(r["b"])({url:"/user/profile",method:"put",data:e})},updateAvatar:function(e){return Object(r["b"])({url:"/user/avatar?avatar=".concat(e),method:"put"})},uploadAvatar:function(e){return Object(r["b"])({url:"/user/avatar/upload",method:"post",data:e})},updatePassword:function(e){return Object(r["b"])({url:"/user/password",method:"put",data:e})},resetPassword:function(e){return Object(r["b"])({url:"/user/reset/".concat(e),method:"put"})},checkUsername:function(e){return Object(r["b"])({url:"/user/check/username",method:"get",params:{username:e}})},checkEmail:function(e){return Object(r["b"])({url:"/user/check/email",method:"get",params:{email:e}})},lockUser:function(e){return Object(r["b"])({url:"/user/lock/".concat(e),method:"put"})},unlockUser:function(e){return Object(r["b"])({url:"/user/unlock/".concat(e),method:"put"})},deleteUser:function(e){return Object(r["b"])({url:"/user",method:"delete",data:e})}};t["a"]=s},eeab:function(e,t,a){},ef6a:function(e,t,a){"use strict";a("fbb9")},f214:function(e,t,a){},fbb9:function(e,t,a){}}]);