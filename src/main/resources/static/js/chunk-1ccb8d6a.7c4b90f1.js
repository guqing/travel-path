(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1ccb8d6a","chunk-01ab632e","chunk-f888a2a0","chunk-4ce941c0"],{"106a":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"account-settings-info-view"},[a("a-row",{attrs:{gutter:16}},[a("a-col",{attrs:{md:24,lg:16}},[a("a-form",{attrs:{layout:"vertical",form:t.form}},[a("a-form-item",{attrs:{label:"原始密码"}},[a("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator",value:["oldPassword",{rules:[{required:!0,message:"请输入原始密码",whitespace:!1}]}],expression:"[\n              'oldPassword',\n              {\n                rules: [\n                  {\n                    required: true,\n                    message: '请输入原始密码',\n                    whitespace: false\n                  }\n                ]\n              }\n            ]"}]})],1),a("a-form-item",{attrs:{label:"新密码"}},[a("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator",value:["newPassword",{rules:[{required:!0,message:"请输入新密码",whitespace:!1},{validator:t.validateToNextPassword}]}],expression:"[\n              'newPassword',\n              {\n                rules: [\n                  {\n                    required: true,\n                    message: '请输入新密码',\n                    whitespace: false\n                  },\n                  {\n                    validator: validateToNextPassword\n                  }\n                ]\n              }\n            ]"}],on:{blur:t.handleConfirmBlur}})],1),a("a-form-item",{attrs:{label:"确认密码"}},[a("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator",value:["confirmPassword",{rules:[{required:!0,message:"再次输入新密码"},{validator:t.compareToFirstPassword}]}],expression:"[\n              'confirmPassword',\n              {\n                rules: [\n                  {\n                    required: true,\n                    message: '再次输入新密码'\n                  },\n                  {\n                    validator: compareToFirstPassword\n                  }\n                ]\n              }\n            ]"}]})],1),a("a-form-item",[a("a-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("确认更改")])],1)],1)],1)],1)],1)},n=[],o=a("c24f"),s={data:function(){return{confirmDirty:!1,confirmPassword:"",validateMessage:{}}},beforeCreate:function(){this.form=this.$form.createForm(this,{name:"updatePassword"})},methods:{handleSubmit:function(t){var e=this;this.form.validateFieldsAndScroll((function(t,a){var r={oldPassword:a.oldPassword,newPassword:a.newPassword};t||e.handleUpdatePassword(r)}))},handleConfirmBlur:function(t){var e=t.target.value;this.confirmDirty=this.confirmDirty||!!e},compareToFirstPassword:function(t,e,a){var r=this.form;e&&e!==r.getFieldValue("newPassword")?a("两次密码不一致，请重新输入"):a()},validateToNextPassword:function(t,e,a){var r=this.form;e&&this.confirmDirty?(r.validateFields(["confirmPassword"],{force:!0}),a()):(e.length<3||e.length>16)&&a("密码长度必须在3-16字符之间")},handleUpdatePassword:function(t){var e=this;o["a"].updatePassword(t).then((function(t){e.form.resetFields(),e.$message.success("修改成功")})).catch((function(t){e.$message.error("修改密码出错，error:".concat(t))}))}}},i=s,c=a("2877"),l=Object(c["a"])(i,r,n,!1,null,null,null);e["default"]=l.exports},"1cde":function(t,e,a){"use strict";a("7166")},"25b1":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-modal",{attrs:{title:"修改头像",visible:t.visible,maskClosable:!1,confirmLoading:t.confirmLoading,width:800,footer:null},on:{cancel:t.cancelHandel}},[a("a-row",[a("a-col",{style:{height:"350px"},attrs:{xs:24,md:12}},[a("vue-cropper",{ref:"cropper",attrs:{img:t.options.img,info:!0,autoCrop:t.options.autoCrop,autoCropWidth:t.options.autoCropWidth,autoCropHeight:t.options.autoCropHeight,fixedBox:t.options.fixedBox},on:{realTime:t.realTime}})],1),a("a-col",{style:{height:"350px"},attrs:{xs:24,md:12}},[a("div",{staticClass:"avatar-upload-preview"},[a("img",{style:t.previews.img,attrs:{src:t.previews.url}})])])],1),a("br"),a("a-row",[a("a-col",{attrs:{lg:2,md:2}},[a("a-upload",{attrs:{name:"file",beforeUpload:t.beforeUpload,showUploadList:!1}},[a("a-button",{attrs:{icon:"upload"}},[t._v("选择图片")])],1)],1),a("a-col",{attrs:{lg:{span:1,offset:2},md:2}},[a("a-button",{attrs:{icon:"plus"},on:{click:function(e){return t.changeScale(1)}}})],1),a("a-col",{attrs:{lg:{span:1,offset:1},md:2}},[a("a-button",{attrs:{icon:"minus"},on:{click:function(e){return t.changeScale(-1)}}})],1),a("a-col",{attrs:{lg:{span:1,offset:1},md:2}},[a("a-button",{attrs:{icon:"undo"},on:{click:t.rotateLeft}})],1),a("a-col",{attrs:{lg:{span:1,offset:1},md:2}},[a("a-button",{attrs:{icon:"redo"},on:{click:t.rotateRight}})],1),a("a-col",{attrs:{lg:{span:2,offset:6},md:2}},[a("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.finish("blob")}}},[t._v("保存")])],1)],1)],1)},n=[],o=(a("b0c0"),a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("c24f")),s={data:function(){return{visible:!1,id:null,confirmLoading:!1,fileList:[],uploading:!1,options:{img:"",autoCrop:!0,autoCropWidth:200,autoCropHeight:200,fixedBox:!0},fileName:"",previews:{}}},methods:{edit:function(t){var e=this;this.fileName=t.name,this.visible=!0;var a=new FileReader;a.readAsDataURL(t),a.onload=function(){e.options.img=a.result}},close:function(){this.id=null,this.visible=!1},cancelHandel:function(){this.close()},changeScale:function(t){t=t||1,this.$refs.cropper.changeScale(t)},rotateLeft:function(){this.$refs.cropper.rotateLeft()},rotateRight:function(){this.$refs.cropper.rotateRight()},beforeUpload:function(t){var e=this,a=new FileReader;return a.readAsDataURL(t),a.onload=function(){e.options.img=a.result},!1},finish:function(t){var e=this;this.$log.debug("starting upload image...");var a=this,r=new FormData;"blob"===t?this.$refs.cropper.getCropBlob((function(t){var n=window.URL.createObjectURL(t);e.model=!0,e.modelSrc=n,r.append("file",t,e.fileName),o["a"].uploadAvatar(r).then((function(t){e.$log.debug("success, upload response:",t.data),a.$emit("success",t.data),a.visible=!1}))})):this.$refs.cropper.getCropData((function(t){e.model=!0,e.modelSrc=t}))},okHandel:function(){var t=this;t.confirmLoading=!0,setTimeout((function(){t.confirmLoading=!1,t.close(),t.$message.success("上传头像成功")}),2e3)},realTime:function(t){this.previews=t}}},i=s,c=(a("1cde"),a("2877")),l=Object(c["a"])(i,r,n,!1,null,"f9442f44",null);e["default"]=l.exports},3283:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"account-settings-info-view"},[a("a-row",{attrs:{gutter:16}},[a("a-col",{attrs:{md:24,lg:16}},[a("a-form",{attrs:{layout:"vertical",form:t.form}},[a("a-form-item",{attrs:{label:"昵称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["nickname",{rules:[{required:!0,message:"昵称不能为空!"}]}],expression:"['nickname', { rules: [{ required: true, message: '昵称不能为空!' }] }]"}],attrs:{placeholder:"给自己起个名字"}})],1),a("a-form-item",{attrs:{label:"Bio"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["description",{rules:[{max:144,message:"个人说明不能超过144字符!"}]}],expression:"['description', { rules: [{ max: 144, message: '个人说明不能超过144字符!' }] }]"}],attrs:{rows:"4",placeholder:"You are not alone."}})],1),a("a-form-item",{attrs:{label:"电子邮件"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["email",{rules:[{type:"email",message:"邮箱地址格式不正确!"},{validator:t.validateDuplicateEmail}]}],expression:"[\n              'email',\n              {\n                rules: [\n                  { type: 'email', message: '邮箱地址格式不正确!' },\n                  {\n                    validator: validateDuplicateEmail\n                  }\n                ]\n              }\n            ]"}],attrs:{placeholder:"exp@admin.com"}})],1),a("a-form-item",{attrs:{label:"手机号码"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["mobile"],expression:"['mobile']"}],attrs:{placeholder:"填写一个手机号"}})],1),a("a-form-item",[a("a-button",{attrs:{type:"primary"},on:{click:t.handleUpdateUserInfo}},[t._v(" 保存 ")])],1)],1)],1)],1)],1)},n=[],o=a("5530"),s=a("c24f"),i=a("5880"),c=a("88bc"),l=a.n(c),u=function(){var t=0;return function(e,a){clearTimeout(t),t=setTimeout(e,a)}}(),d=u,f={name:"BaseSetting",beforeCreate:function(){this.form=this.$form.createForm(this,{name:"user_profile"})},computed:Object(o["a"])(Object(o["a"])({},Object(i["mapGetters"])(["userInfo"])),{},{currentUser:function(){return l()(this.userInfo,"nickname","email","mobile","description")}}),mounted:function(){this.initForm()},methods:{initForm:function(){this.form.setFieldsValue(this.currentUser)},validateDuplicateEmail:function(t,e,a){this.currentUser.email===e&&a(),d((function(){s["a"].checkEmail(e).then((function(t){t.data?a(new Error("邮箱地址已经存在")):a()}))}),500)},handleUpdateUserInfo:function(t){var e=this;t.preventDefault(),this.form.validateFields((function(t,a){t||s["a"].updateProfile(a).then((function(t){e.$message.success("保存成功"),e.$store.dispatch("GetInfo")})).catch((function(t){e.$message.error("更新用户信息出错,error: ".concat(t.message))}))}))}}},m=f,p=a("2877"),h=Object(p["a"])(m,r,n,!1,null,null,null);e["default"]=h.exports},7166:function(t,e,a){},"81b6":function(t,e,a){"use strict";a("82cb")},"82cb":function(t,e,a){},"88bc":function(t,e,a){(function(e){var a=1/0,r=9007199254740991,n="[object Arguments]",o="[object Function]",s="[object GeneratorFunction]",i="[object Symbol]",c="object"==typeof e&&e&&e.Object===Object&&e,l="object"==typeof self&&self&&self.Object===Object&&self,u=c||l||Function("return this")();function d(t,e,a){switch(a.length){case 0:return t.call(e);case 1:return t.call(e,a[0]);case 2:return t.call(e,a[0],a[1]);case 3:return t.call(e,a[0],a[1],a[2])}return t.apply(e,a)}function f(t,e){var a=-1,r=t?t.length:0,n=Array(r);while(++a<r)n[a]=e(t[a],a,t);return n}function m(t,e){var a=-1,r=e.length,n=t.length;while(++a<r)t[n+a]=e[a];return t}var p=Object.prototype,h=p.hasOwnProperty,g=p.toString,v=u.Symbol,b=p.propertyIsEnumerable,w=v?v.isConcatSpreadable:void 0,y=Math.max;function C(t,e,a,r,n){var o=-1,s=t.length;a||(a=U),n||(n=[]);while(++o<s){var i=t[o];e>0&&a(i)?e>1?C(i,e-1,a,r,n):m(n,i):r||(n[n.length]=i)}return n}function O(t,e){return t=Object(t),T(t,e,(function(e,a){return a in t}))}function T(t,e,a){var r=-1,n=e.length,o={};while(++r<n){var s=e[r],i=t[s];a(i,s)&&(o[s]=i)}return o}function _(t,e){return e=y(void 0===e?t.length-1:e,0),function(){var a=arguments,r=-1,n=y(a.length-e,0),o=Array(n);while(++r<n)o[r]=a[e+r];r=-1;var s=Array(e+1);while(++r<e)s[r]=a[r];return s[e]=o,d(t,this,s)}}function U(t){return A(t)||S(t)||!!(w&&t&&t[w])}function j(t){if("string"==typeof t||x(t))return t;var e=t+"";return"0"==e&&1/t==-a?"-0":e}function S(t){return k(t)&&h.call(t,"callee")&&(!b.call(t,"callee")||g.call(t)==n)}var A=Array.isArray;function I(t){return null!=t&&L(t.length)&&!E(t)}function k(t){return N(t)&&I(t)}function E(t){var e=P(t)?g.call(t):"";return e==o||e==s}function L(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=r}function P(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function N(t){return!!t&&"object"==typeof t}function x(t){return"symbol"==typeof t||N(t)&&g.call(t)==i}var $=_((function(t,e){return null==t?{}:O(t,f(C(e,1),j))}));t.exports=$}).call(this,a("c8ba"))},c24f:function(t,e,a){"use strict";var r=a("b775"),n={list:function(t){return Object(r["b"])({url:"/user/list",method:"get",params:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})},create:function(t){return Object(r["b"])({url:"/user",method:"post",data:t})},update:function(t){return Object(r["b"])({url:"/user",method:"put",data:t})},updateProfile:function(t){return Object(r["b"])({url:"/user/profile",method:"put",data:t})},updateAvatar:function(t){return Object(r["b"])({url:"/user/avatar?avatar=".concat(t),method:"put"})},uploadAvatar:function(t){return Object(r["b"])({url:"/user/avatar/upload",method:"post",data:t})},updatePassword:function(t){return Object(r["b"])({url:"/user/password",method:"put",data:t})},resetPassword:function(t){return Object(r["b"])({url:"/user/reset/".concat(t),method:"put"})},checkUsername:function(t){return Object(r["b"])({url:"/user/check/username",method:"get",params:{username:t}})},checkEmail:function(t){return Object(r["b"])({url:"/user/check/email",method:"get",params:{email:t}})},lockUser:function(t){return Object(r["b"])({url:"/user/lock/".concat(t),method:"put"})},unlockUser:function(t){return Object(r["b"])({url:"/user/unlock/".concat(t),method:"put"})},deleteUser:function(t){return Object(r["b"])({url:"/user",method:"delete",data:t})}};e["a"]=n},f2f0:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page-header-index-wide page-header-wrapper-grid-content-main"},[a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{md:24,lg:8}},[a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"account-center-avatarHolder"},[a("div",{staticClass:"avatar",attrs:{title:"点击可以修改头像"}},[a("a-upload",{attrs:{name:"file",showUploadList:!1,beforeUpload:t.handleBeforeUpload}},[a("div",{staticClass:"ant-upload-preview",attrs:{type:"upload"}},[a("a-avatar",{staticClass:"avatar-preview",attrs:{size:"large",icon:"user",src:t.avatar}})],1)])],1),a("div",{staticClass:"username"},[t._v(t._s(t.userInfo.nickname))]),a("div",{staticClass:"bio"},[t._v(t._s(t.userInfo.description))])]),a("div",{staticClass:"account-center-detail"},[a("p",[a("a-icon",{attrs:{type:"crown"}}),t._l(t.userInfo.roleNames,(function(e,r){return a("a-tag",{key:r},[t._v(t._s(e))])}))],2),t.userInfo.email?a("p",{attrs:{title:"邮箱地址"}},[a("a-icon",{attrs:{type:"mail"}}),t._v(t._s(t.userInfo.email)+" ")],1):t._e(),t.userInfo.mobile?a("p",{attrs:{title:"手机号"}},[a("a-icon",{attrs:{type:"phone"}}),t._v(t._s(t.userInfo.mobile)+" ")],1):t._e(),t.userInfo.createTime?a("p",{attrs:{title:"账号年龄"}},[a("a-icon",{attrs:{type:"calendar"}}),t._v(t._s(t._f("dateToNow")(t.userInfo.createTime))+" ")],1):t._e(),t.userInfo.lastLoginTime?a("p",{attrs:{title:"上次登录时间"}},[a("a-icon",{attrs:{type:"safety"}}),t._v(t._s(t._f("formatDate")(t.userInfo.lastLoginTime))+" ")],1):t._e()]),a("a-divider"),a("div",{staticClass:"social-account"},[a("div",{staticClass:"socail-account-title"},[t._v("关联第三方账号")]),a("a-list",{staticClass:"social-account-list",attrs:{"item-layout":"horizontal","data-source":t.socailAccounts},scopedSlots:t._u([{key:"renderItem",fn:function(e,r){return a("a-list-item",{key:r},[e.isConnected?a("a",{attrs:{slot:"actions"},on:{click:function(a){return t.handleUnbindSocial(e.provider)}},slot:"actions"},[t._v(" 取消关联 ")]):a("a",{attrs:{slot:"actions"},on:{click:function(a){return t.handleBindSocialAccount(e.provider)}},slot:"actions"},[t._v(" 关联 ")]),a("a-list-item-meta",[a("a",{attrs:{slot:"title",href:"https://www.antdv.com/"},slot:"title"},[t._v(t._s(e.name))]),a("a-avatar",{attrs:{slot:"avatar",src:e.logo},slot:"avatar"}),a("div",[t._v(t._s(e.isConnected?"已关联":"未关联"))])],1)],1)}}])})],1),a("a-divider",{attrs:{dashed:!0}})],1)],1),a("a-col",{attrs:{md:24,lg:16}},[a("a-card",{staticStyle:{width:"100%"},attrs:{bordered:!1,tabList:t.tabListNoTitle,activeTabKey:t.noTitleKey},on:{tabChange:function(e){return t.handleTabChange(e,"noTitleKey")}}},["base"===t.noTitleKey?a("base-setting"):"password"===t.noTitleKey?a("password-page"):t._e()],1)],1)],1),a("avatar-modal",{ref:"modal",on:{success:t.handleUploadAvatar}})],1)},n=[],o=(a("4160"),a("c975"),a("b0c0"),a("159b"),a("5530")),s=a("c1df"),i=a.n(s),c=a("680a"),l=a("3283"),u=a("106a"),d=a("25b1"),f=a("5880"),m=a("7ded");function p(t){switch(t){case"GITHUB":return{logo:"",name:"GitHub",url:"https://github.com"};case"WEIBO":return{logo:"",name:"微博",url:"https://github.com"};case"GITEE":return{logo:"",name:"Gitee",url:"https://github.com"};case"DINGTALK":return{logo:"",name:"钉钉",url:"https://github.com"};case"BAIDU":return{logo:"",name:"百度",url:"https://github.com"};case"CSDN":return{logo:"",name:"CSDN",url:"https://github.com"};case"CODING":return{logo:"",name:"Coding",url:"https://coding.net"};case"TENCENT_CLOUD":return{logo:"",name:"腾讯云",url:"https://coding.net"};case"OSCHINA":return{logo:"",name:"开源中国",url:"https://coding.net"};case"ALIPAY":return{logo:"",name:"支付宝",url:"https://coding.net"};case"QQ":return{logo:"",name:"QQ",url:"https://coding.net"};case"WECHAT":return{logo:"",name:"微信",url:"https://coding.net"};case"TAOBAO":return{logo:"",name:"淘宝",url:"https://coding.net"};case"GOOGLE":return{logo:"",name:"谷歌",url:"https://coding.net"};case"FACEBOOK":return{logo:"",name:"FaceBook",url:"https://coding.net"};case"DOUYIN":return{logo:"",name:"抖音",url:"https://coding.net"};case"LINKEDIN":return{logo:"",name:"领英",url:"https://coding.net"};case"MICROSOFT":return{logo:"",name:"微软",url:"https://coding.net"};case"MI":return{logo:"",name:"小米",url:"https://coding.net"};case"TOUTIAO":return{logo:"",name:"头条",url:"https://coding.net"};case"TEAMBITION":return{logo:"",name:"Teambition",url:"https://coding.net"};case"RENREN":return{logo:"",name:"人人",url:"https://coding.net"};case"PINTEREST":return{logo:"",name:"Pinterest",url:"https://coding.net"};case"STACK_OVERFLOW":return{name:"StackOverFlow",url:"https://coding.net"};case"HUAWEI":return{name:"华为",url:"https://coding.net"};case"WECHAT_ENTERPRISE":return{logo:"",name:"企业微信",url:"https://coding.net"};case"GITLAB":return{logo:"",name:"Gitlab",url:"https://coding.net"};case"KUJIALE":return{logo:"",name:"酷家乐",url:"https://coding.net"};default:throw new Error("无法获取社交帐号信息")}}var h=a("c24f"),g={components:{RouteView:c["d"],PageView:c["c"],AvatarModal:d["default"],BaseSetting:l["default"],PasswordPage:u["default"]},data:function(){return{page:{width:.5*window.screen.width,height:.5*window.screen.height},userConnectedSocail:[],socailAccounts:[],tabListNoTitle:[{key:"base",tab:"基础设置"},{key:"password",tab:"密码"}],noTitleKey:"base"}},filters:{dateToNow:function(t){return i()(t).toNow(!0)},formatDate:function(t){return i()(t).format("YYYY-MM-DD HH:mm:ss")}},computed:Object(o["a"])({},Object(f["mapGetters"])(["avatar","userInfo"])),mounted:function(){this.handleListUserSocial()},destroyed:function(){window.removeEventListener("message",this.resolveBindResult)},methods:{handleBindSocialAccount:function(t){this.$message.warning("暂不支持绑定")},resolveBindResult:function(t){var e=this;this.$log.debug("解析得到绑定结果:",t.data,t.data.data),t.data.authUser&&Object(m["a"])(t.data.authUser).then((function(t){e.$message.success("绑定成功"),e.handleListUserSocial()})).catch((function(t){e.$message.error("绑定失败:".concat(t.message))}))},handleUnbindSocial:function(t){var e=this;this.$confirm({title:"确定要解除绑定吗?",onOk:function(){Object(m["h"])(t).then((function(t){e.$message.success("解绑成功"),e.handleListUserSocial()}))},onCancel:function(){}})},handleListUserSocial:function(){var t=this;Object(m["d"])().then((function(e){t.userConnectedSocail=e.data,t.handleListSupportSocial()}))},handleListSupportSocial:function(){var t=this;Object(m["c"])().then((function(e){var a=[];e.data.forEach((function(e){var r=p(e);a.push({name:r.name,url:r.url,provider:e,logo:"/icon/".concat(e.toLowerCase(),".png"),isConnected:t.userConnectedSocail.indexOf(e)>-1}),t.socailAccounts=a}))}))},handleBeforeUpload:function(t){return this.$refs.modal.edit(t),!1},handleUploadAvatar:function(t){var e=this;h["a"].updateAvatar(t).then((function(a){e.$message.success("更新成功"),e.$store.commit("SET_AVATAR",t)}))},handleTabChange:function(t,e){this[e]=t}}},v=g,b=(a("81b6"),a("2877")),w=Object(b["a"])(v,r,n,!1,null,"1c077b3a",null);e["default"]=w.exports}}]);