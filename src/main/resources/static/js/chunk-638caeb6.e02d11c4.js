(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-638caeb6"],{"0ec0":function(e,t,n){},"432b":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("5530"),o=n("5880"),r={computed:Object(a["a"])(Object(a["a"])({},Object(o["mapState"])({layout:function(e){return e.app.layout},navTheme:function(e){return e.app.theme},primaryColor:function(e){return e.app.color},colorWeak:function(e){return e.app.weak},fixedHeader:function(e){return e.app.fixedHeader},fixedSidebar:function(e){return e.app.fixedSidebar},contentWidth:function(e){return e.app.contentWidth},autoHideHeader:function(e){return e.app.autoHideHeader},isMobile:function(e){return e.app.isMobile},sideCollapsed:function(e){return e.app.sideCollapsed},multiTab:function(e){return e.app.multiTab}})),{},{isTopMenu:function(){return"topmenu"===this.layout}}),methods:{isSideMenu:function(){return!this.isTopMenu}}}},d93d:function(e,t,n){"use strict";n("0ec0")},e63d:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-card",{attrs:{bordered:!1}},[n("a-row",{attrs:{gutter:8,type:"flex",justify:"center"}},[n("a-col",{attrs:{lg:12,md:24,order:e.isMobile?1:0}},[n("a-spin",{attrs:{tip:"Loading...",spinning:e.treeDataLoading}},[n("a-tree",{attrs:{checkable:"",blockNode:"","expanded-keys":e.expandedMenuKeys,"auto-expand-parent":e.autoExpandParent,"selected-keys":e.selectedKeys,"tree-data":e.menuTreeData},on:{expand:e.onTreeMenuExpand,select:e.onSelect,check:e.onTreeMenuCheck},model:{value:e.checkedMenuKeys,callback:function(t){e.checkedMenuKeys=t},expression:"checkedMenuKeys"}}),0==e.menuTreeData.length?n("a-empty"):e._e()],1)],1),n("a-col",{attrs:{lg:12,md:24}},[n("a-form-model",{ref:"menuForm",attrs:{model:e.menuForm,rules:e.rules,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[n("a-form-model-item",{attrs:{label:"上级菜单"}},[n("a-tree-select",{staticStyle:{width:"100%"},attrs:{allowClear:"","dropdown-style":{maxHeight:"400px",overflow:"auto"},"tree-data":e.menuTreeData,"tree-default-expand-all":""},model:{value:e.menuForm.parentId,callback:function(t){e.$set(e.menuForm,"parentId",t)},expression:"menuForm.parentId"}})],1),n("a-form-model-item",{attrs:{label:"菜单/按钮标题",prop:"title"}},[n("a-input",{attrs:{placeholder:"例如：用户管理"},model:{value:e.menuForm.title,callback:function(t){e.$set(e.menuForm,"title",t)},expression:"menuForm.title"}})],1),n("a-form-model-item",{attrs:{label:"资源类型"}},[n("a-radio-group",{attrs:{"default-value":"0","button-style":"solid"},model:{value:e.menuForm.type,callback:function(t){e.$set(e.menuForm,"type",t)},expression:"menuForm.type"}},[n("a-radio-button",{attrs:{value:"0"}},[e._v(" 菜单 ")]),n("a-radio-button",{attrs:{value:"1"}},[e._v(" 按钮 ")])],1)],1),n("a-form-model-item",{directives:[{name:"show",rawName:"v-show",value:e.showMenuFormItem,expression:"showMenuFormItem"}],attrs:{label:"访问路径",prop:"path"}},[n("a-input",{attrs:{placeholder:"以 / 开头，例如：/user/list"},model:{value:e.menuForm.path,callback:function(t){e.$set(e.menuForm,"path",t)},expression:"menuForm.path"}})],1),n("a-form-model-item",{directives:[{name:"show",rawName:"v-show",value:e.showMenuFormItem,expression:"showMenuFormItem"}],attrs:{label:"路由名称",prop:"name"}},[n("a-input",{attrs:{placeholder:"只能是英文，例如：UserList"},model:{value:e.menuForm.name,callback:function(t){e.$set(e.menuForm,"name",t)},expression:"menuForm.name"}})],1),n("a-form-model-item",{directives:[{name:"show",rawName:"v-show",value:e.showMenuFormItem,expression:"showMenuFormItem"}],attrs:{label:"组件路径",prop:"component"}},[n("a-input",{attrs:{placeholder:"相对于views下的组件，例如:user/UserList"},model:{value:e.menuForm.component,callback:function(t){e.$set(e.menuForm,"component",t)},expression:"menuForm.component"}})],1),n("a-form-model-item",{attrs:{label:"权限标识"}},[n("a-input",{attrs:{placeholder:"使用冒号分割层级，例如user:list"},model:{value:e.menuForm.perms,callback:function(t){e.$set(e.menuForm,"perms",t)},expression:"menuForm.perms"}})],1),n("a-form-model-item",{attrs:{label:"图标"}},[n("a-input",{attrs:{placeholder:"选择一个图标可以展示在菜单标题左侧"},on:{click:e.handleSelectIcon},model:{value:e.menuForm.icon,callback:function(t){e.$set(e.menuForm,"icon",t)},expression:"menuForm.icon"}},[n("a-icon",{attrs:{slot:"suffix",type:e.menuForm.icon||"question-circle",title:"图标预览"},slot:"suffix"})],1)],1),n("a-col",{style:{display:e.moreFormItem?"block":"none"}},[n("a-form-model-item",{directives:[{name:"show",rawName:"v-show",value:e.showMenuFormItem,expression:"showMenuFormItem"}],attrs:{label:"重定向地址"}},[n("a-input",{attrs:{placeholder:"如果填写，点击时会重定向到该地址"},model:{value:e.menuForm.redirect,callback:function(t){e.$set(e.menuForm,"redirect",t)},expression:"menuForm.redirect"}})],1),n("a-form-model-item",{directives:[{name:"show",rawName:"v-show",value:e.showMenuFormItem,expression:"showMenuFormItem"}],attrs:{label:"是否缓存组件"}},[n("a-switch",{attrs:{"checked-children":"是","un-checked-children":"否","default-checked":""},model:{value:e.menuForm.keepAlive,callback:function(t){e.$set(e.menuForm,"keepAlive",t)},expression:"menuForm.keepAlive"}})],1),n("a-form-model-item",{directives:[{name:"show",rawName:"v-show",value:e.showMenuFormItem,expression:"showMenuFormItem"}],attrs:{label:"是否隐藏菜单栏"}},[n("a-switch",{attrs:{"checked-children":"显示","un-checked-children":"隐藏"},model:{value:e.menuForm.hidden,callback:function(t){e.$set(e.menuForm,"hidden",t)},expression:"menuForm.hidden"}})],1),n("a-form-model-item",{attrs:{label:"排序"}},[n("a-input",{attrs:{placeholder:"菜单显示排序"},model:{value:e.menuForm.sortIndex,callback:function(t){e.$set(e.menuForm,"sortIndex",t)},expression:"menuForm.sortIndex"}})],1)],1),n("a-form-model-item",{attrs:{"wrapper-col":e.menuFormButtonWrapperCol}},[n("a-button",{directives:[{name:"action",rawName:"v-action:save",arg:"save"}],attrs:{type:"primary",loading:e.loadingState.save},on:{click:e.handleSaveOrUpdateMenu}},[e._v(" 保存 ")]),n("a-button",{style:{marginLeft:"8px"},attrs:{loading:e.loadingState.reset},on:{click:e.handleResetMenuForm}},[e._v(" 重置 ")]),n("a",{style:{marginLeft:"8px"},on:{click:function(t){e.moreFormItem=!e.moreFormItem}}},[e._v(" 更多 "),n("a-icon",{attrs:{type:e.moreFormItem?"up":"down"}})],1)],1)],1),n("a-modal",{attrs:{title:"选择图标",visible:e.iconSelect.visible},on:{cancel:function(t){e.iconSelect.visible=!1},ok:e.handleIconSelectOk}},[n("icon-selector",{on:{change:e.handleChangeIcon},model:{value:e.iconSelect.selected,callback:function(t){e.$set(e.iconSelect,"selected",t)},expression:"iconSelect.selected"}})],1)],1)],1)],1)},o=[],r=(n("d81d"),n("d3b7"),n("1f27")),i=n("432b"),l=n("13bb"),s=function(e,t,n){if(""!==t){var a=/^[A-Za-z0-9/]+([\w.,@?^=%&:/~+#-]*[\w@?^=%&/~+#-])?$/.test(t);a?n():n(new Error("请输入合法的访问url"))}},m=function(e,t,n){""!==t&&(/^[A-Za-z0-9]+$/.test(t)?n():n(new Error("只能输入字母或数字")))},u=function(e,t,n){if(""!==t){var a=/^[A-Za-z0-9/]+([\w.,@?^=%&:/~+#-]*[\w@?^=%&/~+#-])?$/.test(t);a?n():n(new Error("请输入合法的组件路径"))}},c={name:"TreeList",mixins:[i["a"]],components:{IconSelector:l["a"]},data:function(){return{iconSelect:{visible:!1,selected:""},iconSelectorVisible:!1,loadingState:{save:!1,reset:!1},menuForm:{},treeDataLoading:!1,rules:{title:[{required:!0,message:"请输入菜单或按钮的名称",trigger:"blur"},{max:150,message:"长度不能超过150字符",trigger:"blur"}],path:[{validator:s,trigger:"change"}],name:[{validator:m,trigger:"change"}],component:[{validator:u,trigger:"change"}]},moreFormItem:!1,menuFormButtonWrapperCol:{span:14,offset:4},labelCol:{span:4},wrapperCol:{span:18},queryParam:{},expandedMenuKeys:[],autoExpandParent:!1,checkedMenuKeys:[],selectedKeys:[],menuTreeData:[]}},created:function(){this.listTreeMenu()},computed:{showMenuFormItem:function(){return"0"===(this.menuForm.type||"0")}},methods:{handleChangeIcon:function(e){this.iconSelect.selected=e},handleSelectIcon:function(){this.iconSelect.visible=!0},handleIconSelectOk:function(){this.menuForm.icon=this.iconSelect.selected,this.iconSelect.visible=!1},handleRoleEdit:function(e){var t=e.menuIds,n=t.map(String);this.checkedMenuKeys=n,this.expandedMenuKeys=n},listTreeMenu:function(){var e=this;this.treeDataLoading=!0,r["a"].listTreeMenu().then((function(t){e.menuTreeData=t.data})).catch((function(t){e.menuTreeData=[],e.$message.error("查询出错:".concat(t))})).finally((function(){e.treeDataLoading=!1}))},onTreeMenuExpand:function(e){this.expandedMenuKeys=e,this.autoExpandParent=!1},onTreeMenuCheck:function(e){},onSelect:function(e,t){var n=this;this.handleToggleTreeMenu(e,t),this.selectedKeys=e;var a=e[0];a&&r["a"].getById(a).then((function(e){n.menuForm=e.data,n.handleMenuFormValueConvert()}))},handleMenuFormValueConvert:function(){1===this.menuForm.keepAlive?this.menuForm.keepAlive=!0:this.menuForm.keepAlive=!1,1===this.menuForm.hidden?this.menuForm.hidden=!0:this.menuForm.hidden=!1,0===this.menuForm.parentId&&(this.menuForm.parentId=null)},handleToggleTreeMenu:function(e,t){t.node.dataRef.hasChildren&&(this.expandedMenuKeys=e)},handleSaveOrUpdateMenu:function(){var e=this;this.loadingState.save=!0,this.$refs["menuForm"].validate((function(t){t?(e.menuForm.type="0",r["a"].saveOrUpdate(e.menuForm).then((function(t){e.$message.success("保存成功"),e.listTreeMenu(),e.handleResetMenuForm()})).finally((function(){setTimeout((function(){e.loadingState.save=!1}),1500)}))):setTimeout((function(){e.loadingState.save=!1}),1500)}))},handleResetMenuForm:function(){var e=this;this.loadingState.reset=!0,this.menuForm={},this.checkedMenuKeys=[],this.expandedMenuKeys=[],setTimeout((function(){e.loadingState.reset=!1}),1500)}}},d=c,p=(n("d93d"),n("2877")),h=Object(p["a"])(d,a,o,!1,null,null,null);t["default"]=h.exports}}]);